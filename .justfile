####################################################################################################

_default:
  @just --list

####################################################################################################

# print justfile
@show:
  bat .justfile --language make

####################################################################################################

# edit justfile
@edit:
  micro .justfile

####################################################################################################
# aliases
####################################################################################################

####################################################################################################
# import
####################################################################################################

# config
import '.just/py.conf'

####################################################################################################
# jobs
####################################################################################################

# create enviroment
env:
  #!/bin/bash
  @echo "\n\033[1;36mBuilding\033[0;37m...\n=================================================="
  python -m venv venv

####################################################################################################

# link bpython
link ver=pyver:
  #!/bin/bash
  @echo "\n\033[1;36mLinking\033[0;37m...\n=================================================="
  ln -sf $(which bpython) venv/bin/{{ver}}

####################################################################################################

# build & install locally
install app=pyapp ver="0.0.0":
  @echo "\n\033[1;36mBuilding\033[0;37m...\n=================================================="
  python -m build
  @echo "\n\033[1;36mInstalling\033[0;37m...\n=================================================="
  pip install dist/{{pyapp}}-{{ver}}-py3-none-any.whl
  @echo "\n\033[1;36mLinking\033[0;37m...\n=================================================="
  ln -svf "$(pwd)/venv/bin/{{pyapp}}" "${HOME}/.python/bin"

####################################################################################################

# watch changes
watch:
  watchexec --clear --watch {{pyapp}} -- 'just install'

####################################################################################################
